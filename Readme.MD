# AirSim ROS Noetic & PX4 SITL Docker Integration



[![Docker](https://img.shields.io/badge/docker-ready-blue.svg)](https://www.docker.com/)
[![ROS Noetic](https://img.shields.io/badge/ROS-Noetic-green)](https://wiki.ros.org/noetic)
[![AirSim](https://img.shields.io/badge/AirSim-v1.8.1-orange)](https://github.com/microsoft/AirSim)
[![PX4](https://img.shields.io/badge/PX4-v1.14.3-purple)](https://px4.io/)



---



## üá¨üáß English



### Overview



This repository provides production-ready Dockerfiles to integrate **AirSim** (running on Windows) with **ROS Noetic** and **PX4 SITL** in a Linux container environment. It enables seamless development and testing of autonomous aerial vehicles using high-fidelity simulation, with all dependencies pre‚Äëconfigured.



Two main components are provided:



1. **AirSim ROS Noetic Wrapper** ‚Äì A Docker image with ROS Noetic and the `airsim_ros_pkgs` package. It connects to the AirSim simulator on a Windows host and publishes sensor data (cameras, LiDAR, IMU, GPS, etc.) as ROS topics.

2. **PX4 SITL + MAVSDK Server** ‚Äì A Docker image containing the PX4 Autopilot SITL and MAVSDK server, configured to communicate with AirSim via TCP. This allows you to run a full flight controller in simulation and interact with it using MAVSDK or MAVLink.



Both images are optimized for **WSL2** (Windows Subsystem for Linux) and use `--net=host` for direct network access to the Windows host.



### Features



- **Multi‚Äëstage Dockerfiles** ‚Äì Lightweight, production‚Äëready images with minimal runtime dependencies.

- **ROS Noetic Integration** ‚Äì Full support for `airsim_ros_pkgs`, publishing:

  - Odometry (`/odom_local_ned`)

  - GPS (`/global_gps`)

  - IMU, magnetometer, altimeter

  - Cameras (RGB, depth, segmentation)

  - LiDAR point clouds

- **PX4 SITL** ‚Äì Pre‚Äëbuilt PX4 firmware (v1.14.3) configured for TCP connection to AirSim.

- **MAVSDK Server** ‚Äì Ready‚Äëto‚Äërun gRPC server for programmatic drone control (Python/C++ SDKs).

- **Easy Windows Integration** ‚Äì Works out‚Äëof‚Äëthe‚Äëbox with AirSim on Windows via WSL2.

- **Docker Compose Support** ‚Äì Launch the entire stack (ROS + PX4) with a single command.



### Requirements



- **Windows 10/11** with:

  - [AirSim](https://github.com/microsoft/AirSim) installed and running (Unreal Engine environment)

  - [Docker Desktop](https://www.docker.com/products/docker-desktop/) with WSL2 backend enabled

  - [VcXsrv](https://sourceforge.net/projects/vcxsrv/) or any X11 server (for GUI apps like RViz)

- **Linux/WSL2** environment (Ubuntu 20.04 recommended)



### Quick Start
#### 1. Clone the Repository

```bash
git clone https://github.com/onaqua/airsim-ros-px4-docker.git
cd airsim-ros-px4-docker
```

#### 2. Build the Docker Images

```bash
# Base image with AirLib
docker build -f Dockerfile.airsim-base -t airsim-client-base .

# ROS Noetic + airsim_ros_pkgs
docker build -f Dockerfile.airsim-ros -t airsim-ros-noetic .

# PX4 SITL + MAVSDK Server
docker build -f Dockerfile.px4 -t px4-sitl-mavsdk .
```

#### 3. Configure AirSim on Windows

Edit `AirSim\\settings.json`:

```json
{
  "SettingsVersion": 1.2,
  "SimMode": "Multirotor",
  "Vehicles": {
    "PX4": {
      "VehicleType": "PX4Multirotor",
      "UseSerial": false,
      "UseTcp": true,
      "QgcHostIp": "",
      "TcpPort": 4560,
      "ControlIp": "127.0.0.1",
      "ControlPort": 14580,
      "LocalHostIp": "0.0.0.0",
      "Cameras": {
        "depth_camera": {
          "CameraType": "Depth",
          "Enabled": true,
          "CaptureSettings": [
            {
              "ImageType": 2,
              "Width": 640,
              "Height": 480,
              "FOV_Degrees": 90,
              "AutoExposureSpeed": 100,
              "MotionBlurAmount": 0
            }
          ],
          "X": 0.0, "Y": 0.0, "Z": 0.0,
          "Pitch": 0.0, "Roll": 0.0, "Yaw": 0.0
        }
      },
      "Sensors": {
        "LidarSensor1": {
          "SensorType": 6,
          "Enabled": true,
          "NumberOfChannels": 16,
          "RotationsPerSecond": 10,
          "PointsPerSecond": 100000,
          "X": 0,
          "Y": 0,
          "Z": -1,
          "Roll": 0,
          "Pitch": 0,
          "Yaw": 0,
          "VerticalFOVUpper": -15,
          "VerticalFOVLower": -25,
          "HorizontalFOVStart": -20,
          "HorizontalFOVEnd": 20,
          "DrawDebugPoints": true,
          "DrawMode": 1,
          "DataFrame": "SensorLocalFrame"
        }
      }
    }
  }
}
```

Start AirSim and load your Unreal environment.

#### 4. Launch Containers (in WSL2)

**Run ROS wrapper only:**

```bash
docker run -it --rm --net=host \\
  -e WSL_HOST_IP=host.docker.internal \\
  -e DISPLAY=$DISPLAY \\
  -v /tmp/.X11-unix:/tmp/.X11-unix \\
  airsim-ros-noetic:latest /start_airsim_ros.sh
```

**Run PX4 SITL + MAVSDK only:**

```bash
docker run -it --rm --net=host --privileged \\
  -e WSL_HOST_IP=host.docker.internal \\
  px4-sitl-mavsdk:latest /start_all.sh
```

**Full stack with Docker Compose:**

```bash
docker-compose up
```



### Repository Structure

```
.
‚îú‚îÄ‚îÄ Dockerfile.airsim-base          # Base image with AirLib
‚îú‚îÄ‚îÄ Dockerfile.airsim-ros           # ROS Noetic + airsim_ros_pkgs
‚îú‚îÄ‚îÄ Dockerfile.px4                  # PX4 SITL + MAVSDK Server
‚îú‚îÄ‚îÄ docker-compose.yml              # Compose file for both services
‚îú‚îÄ‚îÄ README.md                       # This file
‚îî‚îÄ‚îÄ scripts/                        # Helper scripts (optional)
```



### Usage Examples



**Subscribe to ROS topics from AirSim** (inside ROS container):

```bash
rostopic list
rostopic echo /airsim_node/PX4/odom_local_ned
rosrun image_view image_view image:=/airsim_node/PX4/front_center/Scene
```

**Control drone with MAVSDK Python** (on host):

```bash
pip3 install mavsdk
```

```python
# takeoff.py
import asyncio
from mavsdk import System

async def run():
    drone = System()
    await drone.connect(system_address="127.0.0.1:50051")
    async for state in drone.core.connection_state():
        if state.is_connected:
            print("Connected!")
            break

    await drone.action.arm()
    await drone.action.takeoff()
    await asyncio.sleep(10)
    await drone.action.land()

asyncio.run(run())
```

```bash
python3 takeoff.py
```

### License
This project is licensed under the MIT License ‚Äì see the [LICENSE](LICENSE) file for details.


---



## üá∑üá∫ –†—É—Å—Å–∫–∏–π



### –û–±–∑–æ—Ä



–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –≥–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é Dockerfile –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ **AirSim** (–∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –Ω–∞ Windows) —Å **ROS Noetic** –∏ **PX4 SITL** –≤ —Å—Ä–µ–¥–µ Linux-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–µ –ª–µ—Ç–∞—Ç–µ–ª—å–Ω—ã–µ –∞–ø–ø–∞—Ä–∞—Ç—ã –≤ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Å–∏–º—É–ª—è—Ü–∏–∏ —Å–æ –≤—Å–µ–º–∏ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.



–î–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:



1. **–û–±—ë—Ä—Ç–∫–∞ AirSim –¥–ª—è ROS Noetic** ‚Äì Docker-–æ–±—Ä–∞–∑ —Å ROS Noetic –∏ –ø–∞–∫–µ—Ç–æ–º `airsim_ros_pkgs`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–∏–º—É–ª—è—Ç–æ—Ä—É AirSim –Ω–∞ Windows –∏ –ø—É–±–ª–∏–∫—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–µ–Ω—Å–æ—Ä–æ–≤ (–∫–∞–º–µ—Ä—ã, –ª–∏–¥–∞—Ä, IMU, GPS –∏ —Ç.–¥.) –≤ —Ç–æ–ø–∏–∫–∏ ROS.

2. **PX4 SITL + MAVSDK Server** ‚Äì Docker-–æ–±—Ä–∞–∑, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π PX4 Autopilot SITL –∏ MAVSDK-—Å–µ—Ä–≤–µ—Ä, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å AirSim –ø–æ TCP. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–æ–ª—ë—Ç–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤ —Å–∏–º—É–ª—è—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–º —á–µ—Ä–µ–∑ MAVSDK –∏–ª–∏ MAVLink.



–û–±–∞ –æ–±—Ä–∞–∑–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è **WSL2** –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `--net=host` –¥–ª—è –ø—Ä—è–º–æ–≥–æ —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ö–æ—Å—Ç—É Windows.



### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏



- **–ú–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ Dockerfile** ‚Äì –ª—ë–≥–∫–∏–µ, –≥–æ—Ç–æ–≤—ã–µ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –æ–±—Ä–∞–∑—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ROS Noetic** ‚Äì –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `airsim_ros_pkgs`, –ø—É–±–ª–∏–∫–∞—Ü–∏—è:

  - –û–¥–æ–º–µ—Ç—Ä–∏–∏ (`/odom_local_ned`)

  - GPS (`/global_gps`)

  - IMU, –º–∞–≥–Ω–∏—Ç–æ–º–µ—Ç—Ä–∞, –∞–ª—å—Ç–∏–º–µ—Ç—Ä–∞

  - –ö–∞–º–µ—Ä (RGB, –≥–ª—É–±–∏–Ω–∞, —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è)

  - –û–±–ª–∞–∫–æ–≤ —Ç–æ—á–µ–∫ —Å –ª–∏–¥–∞—Ä–∞

- **PX4 SITL** ‚Äì –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–±—Ä–∞–Ω–Ω–∞—è –ø—Ä–æ—à–∏–≤–∫–∞ PX4 (v1.14.3), –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ TCP-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ AirSim.

- **MAVSDK Server** ‚Äì –≥–æ—Ç–æ–≤—ã–π –∫ –∑–∞–ø—É—Å–∫—É gRPC-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥—Ä–æ–Ω–æ–º (Python/C++ SDK).

- **–ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Windows** ‚Äì —Ä–∞–±–æ—Ç–∞–µ—Ç ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª —Å AirSim –Ω–∞ Windows —á–µ—Ä–µ–∑ WSL2.

- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Docker Compose** ‚Äì –∑–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞ (ROS + PX4) –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.



### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è



- **Windows 10/11** —Å:

  - –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∏ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º [AirSim](https://github.com/microsoft/AirSim) (–æ–∫—Ä—É–∂–µ–Ω–∏–µ Unreal Engine)

  - [Docker Desktop](https://www.docker.com/products/docker-desktop/) —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º –±—ç–∫–µ–Ω–¥–æ–º WSL2

  - [VcXsrv](https://sourceforge.net/projects/vcxsrv/) –∏–ª–∏ –ª—é–±–æ–π X11-—Å–µ—Ä–≤–µ—Ä (–¥–ª—è GUI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä RViz)

- **–û–∫—Ä—É–∂–µ–Ω–∏–µ Linux/WSL2** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Ubuntu 20.04)



### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç



#### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone https://github.com/onaqua/airsim-ros-px4-docker.git
cd airsim-ros-px4-docker
```



#### 2. –°–æ–±–µ—Ä–∏—Ç–µ Docker-–æ–±—Ä–∞–∑—ã

```bash
docker build -f Dockerfile.airsim-base -t airsim-client-base .
docker build -f Dockerfile.airsim-ros -t airsim-ros-noetic .
docker build -f Dockerfile.px4 -t px4-sitl-mavsdk .
```


#### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ AirSim –Ω–∞ Windows

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `AirSim\\settings.json`:

```json
{
  "SettingsVersion": 1.2,
  "SimMode": "Multirotor",
  "Vehicles": {
    "PX4": {
      "VehicleType": "PX4Multirotor",
      "UseSerial": false,
      "UseTcp": true,
      "QgcHostIp": "",
      "TcpPort": 4560,
      "ControlIp": "127.0.0.1",
      "ControlPort": 14580,
      "LocalHostIp": "0.0.0.0",
      "Cameras": {
        "depth_camera": {
          "CameraType": "Depth",
          "Enabled": true,
          "CaptureSettings": [
            {
              "ImageType": 2,
              "Width": 640,
              "Height": 480,
              "FOV_Degrees": 90,
              "AutoExposureSpeed": 100,
              "MotionBlurAmount": 0
            }
          ],
          "X": 0.0, "Y": 0.0, "Z": 0.0,
          "Pitch": 0.0, "Roll": 0.0, "Yaw": 0.0
        }
      },
      "Sensors": {
        "LidarSensor1": {
          "SensorType": 6,
          "Enabled": true,
          "NumberOfChannels": 16,
          "RotationsPerSecond": 10,
          "PointsPerSecond": 100000,
          "X": 0,
          "Y": 0,
          "Z": -1,
          "Roll": 0,
          "Pitch": 0,
          "Yaw": 0,
          "VerticalFOVUpper": -15,
          "VerticalFOVLower": -25,
          "HorizontalFOVStart": -20,
          "HorizontalFOVEnd": 20,
          "DrawDebugPoints": true,
          "DrawMode": 1,
          "DataFrame": "SensorLocalFrame"
        }
      }
    }
  }
}
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ AirSim –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à–µ Unreal-–æ–∫—Ä—É–∂–µ–Ω–∏–µ.



#### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–≤ WSL2)

**–¢–æ–ª—å–∫–æ ROS-–æ–±—ë—Ä—Ç–∫–∞:**

```bash
docker run -it --rm --net=host \\
  -e WSL_HOST_IP=host.docker.internal \\
  -e DISPLAY=$DISPLAY \\
  -v /tmp/.X11-unix:/tmp/.X11-unix \\
  airsim-ros-noetic:latest /start_airsim_ros.sh
```



**–¢–æ–ª—å–∫–æ PX4 SITL + MAVSDK:**

```bash
docker run -it --rm --net=host --privileged \\
  -e WSL_HOST_IP=host.docker.internal \\
  px4-sitl-mavsdk:latest /start_all.sh
```



**–ü–æ–ª–Ω—ã–π —Å—Ç–µ–∫ —á–µ—Ä–µ–∑ Docker Compose:**

```bash
docker-compose up
```



### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
.
‚îú‚îÄ‚îÄ Dockerfile.airsim-base          # –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å AirLib
‚îú‚îÄ‚îÄ Dockerfile.airsim-ros           # ROS Noetic + airsim_ros_pkgs
‚îú‚îÄ‚îÄ Dockerfile.px4                  # PX4 SITL + MAVSDK Server
‚îú‚îÄ‚îÄ docker-compose.yml              # Compose-—Ñ–∞–π–ª –¥–ª—è –æ–±–æ–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ README.md                       # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ scripts/                        # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```



### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è



**–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–æ–ø–∏–∫–∏ ROS –æ—Ç AirSim** (–≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å ROS):

```bash
rostopic list
rostopic echo /airsim_node/PX4/odom_local_ned
rosrun image_view image_view image:=/airsim_node/PX4/front_center/Scene
```



**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä–æ–Ω–æ–º —á–µ—Ä–µ–∑ MAVSDK Python** (–Ω–∞ —Ö–æ—Å—Ç–µ):

```bash
pip3 install mavsdk
```

```python
# takeoff.py
import asyncio
from mavsdk import System

async def run():
    drone = System()
    await drone.connect(system_address="127.0.0.1:50051")
    async for state in drone.core.connection_state():
        if state.is_connected:
            print("–ü–æ–¥–∫–ª—é—á—ë–Ω!")
            break

    await drone.action.arm()
    await drone.action.takeoff()
    await asyncio.sleep(10)
    await drone.action.land()

asyncio.run(run())
```

```bash
python3 takeoff.py
```

### –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE).
                            
